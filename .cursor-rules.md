# 🤖 Cursor AI Rules — Webflow Developer Starter

This project is a TypeScript-based boilerplate for adding custom code to Webflow projects.  
Use the following rules to ensure all generated code is consistent, performant, and easy to maintain.

---

## 🧱 Project Architecture

- Use **TypeScript** only.
- All logic lives inside `/src/`.
- Entry point is `src/main.ts`.
- Use named exports for all functions/components.
- Avoid default exports.
- Keep functions pure and modular when possible.

---

## 📁 Folder Structure

| Folder                         | Purpose                                                              |
| ------------------------------ | -------------------------------------------------------------------- |
| `src/components/animations/`   | GSAP animations (`scrollReveal`, `fadeOnScroll`, etc.)               |
| `src/components/interactions/` | Interactive UI logic (`accordion`, `tabs`, `toggle`)                 |
| `src/components/ui/`           | JavaScript visual UI enhancements (`magneticButton`, `cursor`, etc.) |
| `src/utils/`                   | Pure utility functions (`wait`, `clamp`, `debounce`)                 |
| `dist/`                        | Auto-generated output (never edit manually)                          |
| `tests/`                       | HTML test files for Live Server testing                              |

---

## 🧩 Component Authoring Best Practices

- Each component should be a standalone `.ts` file placed in its proper folder (see structure above).
- Use **camelCase** file names (`scrollReveal.ts`, `fadeOnScroll.ts`).
- Export only one function per file:

```ts
export const scrollReveal = () => { ... }
```

- Optionally export type definitions:

```ts
export type ScrollRevealOptions = {
  delay?: number;
};
```

- In `main.ts`, import components explicitly:

```ts
import { scrollReveal } from './components/animations/scrollReveal';
import { setupAccordion } from './components/interactions/accordion';

Webflow.push(() => {
  scrollReveal();
  setupAccordion();
});
```

---

## 🔄 Webflow Integration

- Always wrap logic in `Webflow.push(() => { ... })` to ensure it runs after Webflow is fully initialized.
- Use `data-*` attributes for all element targeting in JavaScript, not class names.

### Example:

```ts
Webflow.push(() => {
  const elements = document.querySelectorAll('[data-reveal]');
  elements.forEach((el) => {
    gsap.from(el, {
      opacity: 0,
      y: 30,
      duration: 1,
      scrollTrigger: {
        trigger: el,
        start: 'top 80%',
      },
    });
  });
});
```

- Never use `DOMContentLoaded`; always rely on `Webflow.push`.

---

## ⚙️ Libraries & Tools

- Use [GSAP](https://gsap.com/) for all animations.
- Register plugins explicitly (e.g. ScrollTrigger).
- Use `@finsweet/ts-utils` for useful helpers like `wait`, `setCSSVar`, etc.

---

## ✨ DOM Targeting Best Practices

- ✅ Use `data-*` attributes (e.g., `data-reveal`, `data-delay`) to link Webflow elements to animations or logic.
- ✅ Use `class` for styling only (CSS, Tailwind, etc.).
- ⚠️ If you must use `.className` in JavaScript, limit it to internal logic and avoid mixing with Webflow styling classes.
- ❌ Avoid relying on class names generated by Webflow for JavaScript targeting (they can change or be duplicated).
- ❌ Avoid using `#id` unless you're targeting a unique, static element (e.g., for scroll-to).

---

## 🎨 Code Style (ESLint + Prettier)

- `semi: true`
- `singleQuote: true`
- `trailingComma: 'es5'`
- `tabWidth: 2`
- Prefer `const`, use `let` only when necessary
- Never use `var`
- No `console.log` in production
- Use ES module imports:
  ```ts
  import { wait } from '@finsweet/ts-utils';
  ```

---

## 📦 Available Scripts (via PNPM)

| Script           | Purpose                             |
| ---------------- | ----------------------------------- |
| `pnpm dev`       | Start local dev server (Vite)       |
| `pnpm build`     | Compile to `/dist/main.js` (Tsup)   |
| `pnpm lint`      | Run ESLint                          |
| `pnpm lint:fix`  | Auto-fix lint errors                |
| `pnpm format`    | Format with Prettier                |
| `pnpm check`     | Type-check only                     |
| `pnpm changeset` | Create version changelog            |
| `pnpm release`   | Trigger npm release (if configured) |

---

## 🌍 CDN Integration (jsDelivr)

Use jsDelivr to serve your built JavaScript directly into Webflow:

```html
<script src="https://cdn.jsdelivr.net/gh/USERNAME/REPO@VERSION/dist/main.js"></script>
```

- Replace:
  - `USERNAME`: your GitHub username
  - `REPO`: repository name
  - `VERSION`: a valid tag (e.g. `v1.0.0`)
- Paste this script into **Webflow > Site Settings > Custom Code > Before `</body>`**

---

## 👥 Contributing Workflow

- Use feature branches:
  - `feature/add-accordion`, `fix/scroll-animation`
- Run `pnpm changeset` before opening PR
- Push your branch and open a PR
- Wait for CI to pass (lint + build)
- Merge the PR
- Merge the Changesets PR to publish

---

## 🧠 Cursor Prompting Examples

> “Create a scroll animation for `[data-reveal]` elements using GSAP and ScrollTrigger. Place the logic in `src/components/animations/scrollReveal.ts` and call it from `main.ts`.”

> “Write a `clamp()` utility in `src/utils/clamp.ts` and add tests in `tests/index.html`.”

---

## ✅ DOs

- ✅ Use `Webflow.push`
- ✅ Target elements with `data-*`
- ✅ Use GSAP + ScrollTrigger
- ✅ Write strongly typed code (TS)
- ✅ Register GSAP plugins explicitly
- ✅ Separate visual (`class`) and logic (`data-*`)
- ✅ Organize components by domain (animations / interactions / ui)

---

## ❌ DON’Ts

- ❌ Don’t use `.className` for JS behavior unless absolutely needed
- ❌ Don’t manipulate DOM outside `Webflow.push`
- ❌ Don’t log in production
- ❌ Don’t modify `/dist/` manually
- ❌ Don’t use jQuery or non-typed libraries
